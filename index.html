<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MickyChat - Painel</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Pequenos ajustes para botÃµes de ediÃ§Ã£o/exclusÃ£o */
    .funil-card {
      background: rgba(255, 255, 255, 0.07);
      border-radius: 12px;
      width: 260px;
      height: 120px;
      padding: 15px;
      color: white;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.2s ease;
    }

    .funil-nome {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 8px;
      outline: none;
      user-select: text;
    }

    .funil-acoes {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .btn-editar,
    .btn-excluir {
      background: #30cfd0;
      border: none;
      border-radius: 6px;
      padding: 5px 10px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .btn-editar:hover,
    .btn-excluir:hover {
      background-color: #26bfbf;
    }

    .btn-excluir {
      background: #e55353;
      color: white;
    }

    .btn-excluir:hover {
      background-color: #bf4747;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- MENU LATERAL: Sempre fixo Ã  esquerda -->
    <aside class="sidebar">
      <div class="logo">ğŸ’  <strong>MickyChat</strong></div>
      <nav>
        <ul>
          <li class="ativo" data-section="metricas">ğŸ“Š MÃ©tricas</li>
          <li data-section="conexao">ğŸ”Œ ConexÃ£o</li>
          <li data-section="funis">ğŸ§© Funis</li>
          <li data-section="disparos">ğŸš€ Disparos</li>
          <li data-section="suporte">ğŸ’¬ Suporte</li>
          <li data-section="extensao">ğŸ§· ExtensÃ£o Web</li>
          <li data-section="sair">ğŸšª Sair</li>
        </ul>
      </nav>
      <div class="whatsapp-help">
        <a href="https://wa.me/SEUNUMERO" target="_blank" rel="noopener">â“ Ajuda via WhatsApp</a>
      </div>
    </aside>

    <!-- CONTEÃšDO PRINCIPAL -->
    <main class="conteudo">
      <!-- SeÃ§Ã£o MÃ©tricas -->
      <section id="metricas" class="secao ativa">
        <h2>ğŸ“Š MÃ©tricas</h2>
        <p>Resumo do sistema e estatÃ­sticas futuras aparecerÃ£o aqui.</p>
      </section>

      <!-- SeÃ§Ã£o ConexÃ£o -->
      <section id="conexao" class="secao">
        <h2 class="conexao-titulo">ConexÃ£o</h2>
        <p class="conexao-subtitulo">Conecte e verifique sua conexÃ£o com o WhatsApp.</p>
        <div class="box-conexao">
          <div class="status-conexao">
            <strong>Status:</strong>
            <span id="status-indicador" class="desconectado">Desconectado</span>
          </div>
          <button class="botao-primario" onclick="mostrarNumero()">ğŸ“± Conecte um nÃºmero</button>
          <button class="botao-destaque" onclick="gerarQRCode()">Conectar via QR-Code</button>
          <div id="mensagem-qrcode" class="mensagem-qrcode" style="display:none">
            â³ Gerando QR-Codeâ€¦ pode levar atÃ© 1 minuto.
          </div>
          <div id="qrcode-area" class="qrcode-area" style="display:none">
            <!-- Aqui aparecerÃ¡ a imagem do QR-Code gerado -->
            <img src="qrcode-placeholder.png" alt="QR Code" />
          </div>
          <div class="alternativa-numero">
            <a href="#" onclick="abrirConexaoNumero()">Ou conectar com nÃºmero</a>
          </div>
          <div id="conectar-por-numero" class="box-numero" style="display:none;">
            <label for="pais-select">Escolha seu paÃ­s:</label>
            <select id="pais-select" onchange="atualizarCodigo()">
              <option value="+258" selected>ğŸ‡²ğŸ‡¿ MoÃ§ambique (+258)</option>
              <option value="+55">ğŸ‡§ğŸ‡· Brasil (+55)</option>
              <option value="+351">ğŸ‡µğŸ‡¹ Portugal (+351)</option>
              <option value="+244">ğŸ‡¦ğŸ‡´ Angola (+244)</option>
              <!-- Adicione mais paÃ­ses conforme necessÃ¡rio -->
            </select>
            <div class="numero-input">
              <span id="codigo-pais">+258</span>
              <input type="text" id="numero-wpp" placeholder="Digite seu nÃºmero" />
            </div>
            <button class="botao-destaque" onclick="conectarPorNumero()">Conectar via NÃºmero</button>
          </div>
        </div>
      </section>

      <!-- SeÃ§Ã£o Funis -->
      <section id="funis" class="secao">
        <div class="funil-header">
          <h1 class="funis-titulo">ğŸ“ˆ Funis de Venda</h1>
          <p class="funis-descricao">
            Crie fluxos automatizados que iniciam assim que um cliente entrar em contacto com vocÃª.
          </p>
          <div class="funil-controle-topo">
            <span>Exibindo <span id="contador-funis">0</span> funis criados</span>
            <button class="criar-funil-btn" onclick="criarNovoFunil()">â• Criar Funil</button>
          </div>
        </div>
        <div class="funil-grid" id="lista-funis">
          <!-- Funis serÃ£o inseridos dinamicamente aqui -->
        </div>
      </section>

      <!-- SeÃ§Ã£o Disparos -->
      <section id="disparos" class="secao">
        <h2>ğŸš€ Disparos</h2>
        <p>Controle de conversas ativas, envio e pausa manual aparecerÃ£o aqui.</p>
      </section>

      <!-- SeÃ§Ã£o Suporte -->
      <section id="suporte" class="secao">
        <h2>ğŸ’¬ Suporte AutomÃ¡tico</h2>
        <p>Escolha abaixo uma dÃºvida ou problema:</p>
        <div class="suporte-perguntas">
          <button onclick="respostaSuporte('pagamento')">ğŸ’³ Como efectuar o pagamento?</button>
          <button onclick="respostaSuporte('teste')">ğŸ Como funciona o teste grÃ¡tis?</button>
          <button onclick="respostaSuporte('erro')">âŒ Fiz pagamento e nÃ£o desbloqueou</button>
          <button onclick="respostaSuporte('humano')">ğŸ‘¨ Quero falar com um humano</button>
          <button onclick="respostaSuporte('sugestao')">ğŸ“¨ Quero dar sugestÃ£o ou reclamar</button>
        </div>
        <div id="resposta-suporte" class="suporte-resposta"></div>
      </section>

      <!-- SeÃ§Ã£o ExtensÃ£o -->
      <section id="extensao" class="secao">
        <h2>ğŸ§· ExtensÃ£o Web - MChat Helper</h2>
        <p>Clique abaixo para baixar a extensÃ£o que facilita a automaÃ§Ã£o no seu navegador.</p>
        <button onclick="baixarExtensao()">â¬‡ï¸ Baixar ExtensÃ£o (.zip)</button>
      </section>

      <!-- SeÃ§Ã£o Sair -->
      <section id="sair" class="secao">
        <h2>ğŸšª Sair</h2>
        <p>VocÃª saiu do sistema com sucesso.</p>
        <button onclick="window.location.reload()">ğŸ” Recarregar</button>
      </section>
    </main>
  </div>

  <script>
    const listaFunis = document.getElementById('lista-funis');
    const contadorFunis = document.getElementById('contador-funis');

    let funis = [];

    function criarNovoFunil() {
      const nomeInicial = 'Funil sem tÃ­tulo';
      const id = Date.now();
      funis.push({ id, nome: nomeInicial });
      atualizarListaFunis();
    }

    function atualizarListaFunis() {
      listaFunis.innerHTML = '';
      funis.forEach(funil => {
        const card = document.createElement('div');
        card.className = 'funil-card';
        card.dataset.id = funil.id;

        card.innerHTML = `
          <div class="funil-nome" contenteditable="false" spellcheck="false">${funil.nome}</div>
          <div class="funil-acoes">
            <button class="btn-editar" title="Editar nome">âœï¸</button>
            <button class="btn-excluir" title="Excluir funil">ğŸ—‘ï¸</button>
          </div>
        `;

        listaFunis.appendChild(card);

        const btnEditar = card.querySelector('.btn-editar');
        const btnExcluir = card.querySelector('.btn-excluir');
        const nomeDiv = card.querySelector('.funil-nome');

        btnEditar.onclick = () => {
          if (nomeDiv.isContentEditable) {
            nomeDiv.contentEditable = 'false';
            btnEditar.textContent = 'âœï¸';
            funil.nome = nomeDiv.textContent.trim() || 'Funil sem tÃ­tulo';
            atualizarContador();
          } else {
            nomeDiv.contentEditable = 'true';
            nomeDiv.focus();
            btnEditar.textContent = 'ğŸ’¾';
          }
        };

        btnExcluir.onclick = () => {
          if (confirm('Deseja realmente excluir este funil?')) {
            funis = funis.filter(f => f.id !== funil.id);
            atualizarListaFunis();
            atualizarContador();
          }
        };

        nomeDiv.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            btnEditar.click();
          }
        });
      });
      atualizarContador();
    }

    function atualizarContador() {
      contadorFunis.textContent = funis.length;
    }

    // Inicializa com lista vazia
    atualizarListaFunis();
  </script>
</body>
</html>
